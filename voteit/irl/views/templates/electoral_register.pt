<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      metal:use-macro="load: ${api.template_dir}content.pt"
	  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
	  i18n:domain="voteit.irl">
<body>
<h1 metal:fill-slot="page_heading" i18n:translate="">Electoral Register</h1>
<div metal:fill-slot="content" class="content_wrapper">

    <a href="${request.resource_url(context, 'diff_electoral_register')}"
       i18n:translate="">Diff electoral registers</a><br/>
    
    <div tal:condition="new_reg_needed" i18n:translate="">
        A new electoral register is needed.
        The curreny register differs from the users who've got the permission to vote.
    </div>
    <div tal:condition="not new_reg_needed" i18n:translate="">
        No new electoral register needed.
        The latest one has the same information as the users who're currently able to vote.
    </div>

    <div tal:condition="api.show_moderator_actions">
        <a class="buttonize" 
           href="${request.resource_url(context, 'electoral_register', query={'update_register': 1})}">
           <span tal:condition="new_reg_needed" i18n:translate="">Update electoral register</span>
           <span tal:condition="not new_reg_needed" i18n:translate="">Update electoral register anyway</span>
        </a>
    </div>

    <h2 i18n:translate="">All electoral registers</h2>
    <div i18n:translate="">Click the ID of a specific one to view it.</div>

    <table class="listing">
        <thead>
            <tr>
                <th class="heading" i18n:translate="">ID</th>
                <th class="heading" i18n:translate="">Time</th>
                <th class="heading" i18n:translate="">Voters</th>
            </tr>
        </thead>
        <tbody>
        <tal:iterate repeat="item registers_list">
            <tr tal:attributes="class repeat.item.odd and 'odd' or '';">
                <td>
                    <a href="${view_reg_link(item[0])}">
                        ${item[0]}
                    </a>
                </td>
                <td>${api.dt_util.dt_format(item[1]['time'])}</td>
                <td>${len(item[1]['userids'])}</td>
            </tr>
        </tal:iterate>
        </tbody>
    </table>


</div>
</body>
</html>
